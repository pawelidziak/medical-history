<section class="occurrence-list">

  <div *ngIf="loading" class="my-spinner">
    <mat-spinner></mat-spinner>
  </div>

  <div *ngIf="!loading" class="my-spinner">

    <div class="occurrence-header">
      <span>Occurrences:</span>
      <button mat-icon-button (click)="showOccurrenceOption = !showOccurrenceOption" *ngIf="!showOccurrenceOption">
        <mat-icon aria-label="More icon">more_vert</mat-icon>
      </button>

      <div *ngIf="showOccurrenceOption">
        <button mat-icon-button (click)="updateOccurrence()">
          <mat-icon aria-label="Confirm item icon" class="material-color-green">check</mat-icon>
        </button>

        <button mat-icon-button (click)="showOccurrenceOption = false">
          <mat-icon aria-label="Cancel item icon" class="material-color-red">close</mat-icon>
        </button>
      </div>
    </div>

    <ul>
      <li *ngFor="let occurrence of userOccurrences; let i=index; let last = last" [routerLinkActive]="['active']"
          class="list-item" [ngClass]="{'list-item_hover': !showOccurrenceOption}">
        <span *ngIf="!showOccurrenceOption">{{occurrence.name}}</span>

        <mat-form-field floatPlaceholder="never" *ngIf="showOccurrenceOption" style="width: 100%;">
          <input matInput [(ngModel)]="userOccurrences[i].name" type="text">
        </mat-form-field>

        <div class="list-item-right" *ngIf="showOccurrenceOption">
          <button mat-icon-button [matMenuTriggerFor]="confirmDeleteOption">
            <mat-icon aria-label="Delete icon" class="">delete</mat-icon>
          </button>
          <mat-menu #confirmDeleteOption>
            <button mat-menu-item>No</button>
            <button mat-menu-item (click)="deleteOccurrence(i)">Yes</button>
          </mat-menu>

          <div class="moves">
            <button mat-icon-button *ngIf="i>0" (click)="moveElementUp(i)">
              <mat-icon aria-label="Move up icon">keyboard_arrow_up</mat-icon>
            </button>
            <button mat-icon-button *ngIf="!last" (click)="moveElementDown(i)">
              <mat-icon aria-label="Move down icon">keyboard_arrow_down</mat-icon>
            </button>
          </div>

        </div> <!-- end of list-item-right-->

      </li>
    </ul>

    <div class="add-item">
      <mat-form-field *ngIf="addNewOccurrence" floatPlaceholder="never">
        <input matInput placeholder="Enter the name" [formControl]="occurrenceInput">
      </mat-form-field>

      <button mat-icon-button *ngIf="addNewOccurrence" (click)="addOccurrence()">
        <mat-icon aria-label="Confirm item icon" class="material-color-green">check</mat-icon>
      </button>

      <button mat-mini-fab *ngIf="!addNewOccurrence" (click)="addNewOccurrence = true;">
        <mat-icon aria-label="Add item icon">add</mat-icon>
      </button>

      <button mat-icon-button *ngIf="addNewOccurrence" (click)="addNewOccurrence = false">
        <mat-icon aria-label="Cancel item icon" class="material-color-red">close</mat-icon>
      </button>
    </div>

  </div> <!-- end of spinner-->
</section>
